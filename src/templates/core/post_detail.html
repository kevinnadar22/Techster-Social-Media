{% extends 'core/base.html' %}
{% load static %}
{% load custom_tag %}

{% block title %}Techster{% endblock title %}

{% block content %}


    <header>
        <div class="header_inner">
            <div class="left-side">
               <!-- Logo -->
               <div  id="logo">
                <a href="/">
                    <b><h1 class="p-5" style="text-transform: uppercase;padding-right: 45px;;">Techster</h1></b>
                </a>
            </div>
                <!--<div class="triger" uk-toggle="target: #wrapper ; cls: sidebar-active">
                    <i class="uil-bars"></i>
                </div>-->

                <div class="header_search">
                    <input type="text" placeholder="Search for username..">
                    <div class="icon-search">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                            stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                        </svg>
                    </div>
                </div>

            </div>
            <div class="right-side lg:pr-4">
                 <!-- upload -->
                <a href="#"
                    class="bg-pink-500 flex font-bold hidden hover:bg-pink-600 hover:text-white inline-block items-center lg:block mr-4 px-4 py-2 rounded shado text-white">
                    <ion-icon name="add-circle" class="-mb-1
                     mr-1 opacity-90 uilus-circle"></ion-icon> Upload Post
                </a>
                 <!-- upload dropdown box -->
                <div uk-dropdown="pos: top-right;mode:click ; animation: uk-animation-slide-bottom-small" class="header_dropdown">

                    <!-- notivication header -->
                    <div class="px-4 py-3 -mx-5 -mt-4 mb-5 border-b">
                        <h4>Upload Post</h4>
                    </div>

                    <!-- notification contents -->
                    <div class="flex justify-center flex-center text-center">

                        <div class="flex flex-col choose-upload text-center">
                           
                            <div class="bg-gray-100 border-2 border-dashed flex flex-col h-24 items-center justify-center relative w-full rounded-lg  ">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-12">
                                    <path d="M5.5 13a3.5 3.5 0 01-.369-6.98 4 4 0 117.753-1.977A4.5 4.5 0 1113.5 13H11V9.413l1.293 1.293a1 1 0 001.414-1.414l-3-3a1 1 0 00-1.414 0l-3 3a1 1 0 001.414 1.414L9 9.414V13H5.5z" />
                                    <path d="M9 13h2v5a1 1 0 11-2 0v-5z" />
                                </svg>
                            </div>

                            <p class="my-3 leading-6"> Upload Images <br> please upload her ..
                            </p>

                            {% comment %} Upload Post {% endcomment %}

                        <form method="post" action="{% url 'upload_post' %}" enctype="multipart/form-data"> {% csrf_token %}
                            <div uk-form-custom>

                                <input name="image" type="file" accept="image/*">
                                <a href="#" class="button soft-warning small"> Choose file</a>
                                
                            </div>

                            <textarea type="text" class="mt-5" name="caption" id="captions" placeholder="Post Caption"  cols="30" rows="10"></textarea>

                            <div uk-form-custom class="mt-5">
                                <input  type="submit">
                                
                            </div>
                        </form>

                        {% comment %} Upload Post {% endcomment %}


                        </div>

                        <div class="uk-flex uk-flex-column choose-upload" hidden>
                            <div class="mx-auto flex flex-col h-24 items-center justify-center relative w-full rounded-lg">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-12">
                                    <path fill-rule="evenodd" d="M2 9.5A3.5 3.5 0 005.5 13H9v2.586l-1.293-1.293a1 1 0 00-1.414 1.414l3 3a1 1 0 001.414 0l3-3a1 1 0 00-1.414-1.414L11 15.586V13h2.5a4.5 4.5 0 10-.616-8.958 4.002 4.002 0 10-7.753 1.977A3.5 3.5 0 002 9.5zm9 3.5H9V8a1 1 0 012 0v5z" clip-rule="evenodd" />
                                </svg>
                            </div>
                            <p class="my-3 leading-6"> Import videos from YouTube <br> Copy / Paste your video link here </p>
                            <form class="uk-grid-small" uk-grid>
                                <div class="uk-width-expand">
                                    <input type="text" class="uk-input uk-form-small  bg-gray-200 " style="box-shadow:none" placeholder="Paste link">
                                </div>
                                <div class="uk-width-auto"> <button type="submit" class="button soft-warning -ml-2">
                                        Import </button> </div>
                            </form>
                            <a href="#" class="uk-text-muted mt-3 uk-link"
                                uk-toggle="target: .choose-upload ; animation: uk-animation-slide-left-small, uk-animation-slide-right-medium; queued: true">
                                Or Upload Video </a>
                        </div>

                    </div>
                    <div class="px-4 py-3 -mx-5 -mb-4 mt-5 border-t text-sm">
                        Your Video size Must be Maxmium 999MB
                    </div>
                </div>
                
                 <!-- Notification -->

                <a href="#" class="header-links-item">
                    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><g fill="none"><path d="M12 22a2.02 2.02 0 0 1-2.01-2h4a2.02 2.02 0 0 1-.15.78a2.042 2.042 0 0 1-1.44 1.18h-.047A1.922 1.922 0 0 1 12 22zm8-3H4v-2l2-1v-5.5a8.065 8.065 0 0 1 .924-4.06A4.654 4.654 0 0 1 10 4.18V2h4v2.18c2.579.614 4 2.858 4 6.32V16l2 1v2z" fill="currentColor"/></g></svg>
                </a>
                <div uk-drop="mode: click;offset: 4" class="header_dropdown">
                    <h4
                        class="-mt-5 -mx-5 bg-gradient-to-t from-gray-100 to-gray-50 border-b font-bold px-6 py-3">
                        Notification </h4>
                    <ul class="dropdown_scrollbar" data-simplebar>
                        <li>
                            <a href="#">
                                <div class="drop_avatar"> <img src="{% static 'assets/images/avatars/avatar-1.jpg' %}" alt="">
                                </div>
                                <div class="drop_content">
                                    <p> <strong class="text-link" >Taiye</strong>  
                                        <span class="text-link"> is following you  </span>
                                    </p>
                                    <span class="time-ago"> 2 hours ago </span>
                                </div>
                            </a>
                        </li>
                        

                    </ul>
                    <a href="#" class="see-all">See all</a>
                </div>

                <!-- Messages -->

                <a href="#" class="header-links-item">
                    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="0.5em" height="0.5em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 16 16"><g fill="currentColor"><path d="M2 0a2 2 0 0 0-2 2v8a2 2 0 0 0 2 2h2.5a1 1 0 0 1 .8.4l1.9 2.533a1 1 0 0 0 1.6 0l1.9-2.533a1 1 0 0 1 .8-.4H14a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z"/></g></svg>
                </a>
                <div uk-drop="mode: click;offset: 4" class="header_dropdown">
                    <h4
                        class="-mt-5 -mx-5 bg-gradient-to-t from-gray-100 to-gray-50 border-b font-bold px-6 py-3">
                        Messages </h4>
                    <ul class="dropdown_scrollbar" data-simplebar>
                        <li>
                            <a href="#">
                                <div class="drop_avatar"> <img src="{% static 'assets/images/avatars/avatar-1.jpg' %}" alt="">
                                </div>
                                <div class="drop_content">
                                    <strong> Taiye </strong> <time> 6:43 PM</time>
                                    <p> hi tomi </p>
                                </div>
                            </a>
                        </li>
                        


                    </ul>
                    <a href="#" class="see-all">See all</a>
                </div>

                <!-- profile -->

                <a href="#">
                    <img src="/media/{% get_profile_image request.user %}" class="header-avatar" alt="">
                </a>
                <div uk-drop="mode: click;offset:9" class="header_dropdown profile_dropdown border-t">
                    <ul>
                        <li><a href="{% url 'edit_profile' %}">Account settings</a> </li>
                        <li><a href="{% url 'profile' request.user %}">Profile </a> </li>
                        <li><a href="{% url 'favorite_view' %}">Favorites </a> </li>
                        <li><a href="{% url 'logout' %}"> Log Out</a></li>
                    </ul>
                </div>

            </div>
        </div>
    </header>

    <div class="container m-auto">

        <!--<h1 class="lg:text-2xl text-lg font-extrabold leading-none text-gray-900 tracking-tight mb-5"> Feed </h1>--->

        <div class="lg:flex justify-center lg:space-x-10 lg:space-y-0 space-y-5">

            <!-- left sidebar-->
            <div class="space-y-5 flex-shrink-0 lg:w-7/12 infinite-container">

                <!-- post 1-->
            
              

                <div id="{{post.id}}" class="bg-white shadow rounded-md  -mx-2 lg:mx-0 infinite-item">

                    <!-- post header-->
                    <div class="flex justify-between items-center px-4 py-3">
                        <div class="flex flex-1 items-center space-x-4">
                            <a href="#">
                                <div class="bg-gradient-to-tr from-yellow-600 to-pink-600 p-0.5 rounded-full">  
                                    <img src="/media/{{ post.user_profile.profile_image}}" class="bg-gray-200 border border-white rounded-full w-8 h-8">
                                </div>
                            </a>
                            
                            <a href="{% url 'profile' post.user %}"><span class="block capitalize font-semibold "> {{post.user}} </span></a>
                        </div>

                      <div>
                        <a href="#"> <i class="icon-feather-more-horizontal text-2xl hover:bg-gray-200 rounded-full p-2 transition -mr-1 "></i> </a>
                        <div class="bg-white w-56 shadow-md mx-auto p-2 mt-12 rounded-md text-gray-500 hidden text-base border border-gray-100" uk-drop="mode: click;pos: top-right">

                            <ul class="space-y-1">
                                <li> 

                                      {% comment %} Share {% endcomment %}
                                  <a href="#" class="flex items-center px-3 py-2 hover:bg-gray-200 hover:text-gray-800 rounded-md ">
                                      <div style="cursor: pointer;" class="p-2 rounded-full text-black">
                                          <i class="fa-solid fa-share-nodes"></i>
                                    </div>
                                <span>Share</span>
                                      </a> 
                                </li>


                                {% if post.user == request.user %}
                                <li> 
                                  {% comment %} Edit Post {% endcomment %}
                                    <a href="{% url 'edit_post' post.id %}" class="flex items-center px-3 py-2 hover:bg-gray-200 hover:text-gray-800 rounded-md ">

                                      <div style="cursor: pointer;" class="p-2 rounded-full text-black">
                                          <i class="fa-solid fa-pen-to-square"></i>
                                      </div>
                                      <span> Edit Post </span>
                                     
                                    </a> 
                                </li>
                           
                                <li> 
                                    <a href="" class="flex items-center px-3 py-2 hover:bg-gray-200 hover:text-gray-800 rounded-md ">
                                      <div style="cursor: pointer;" class="p-2 rounded-full text-black">
                                          <i class="fa-solid fa-comment-slash"></i>  
                                 
                                      </div>
                                      <span>Disable</span>
                                    </a> 
                                </li> 
                                {% endif %}

                                <li> 
                                    {% comment %} Add Favorites {% endcomment %}
                                    <a id="favorites#{{post.id}}" href="#" class="flex items-center px-3 py-2 hover:bg-gray-200 hover:text-gray-800 rounded-md favorites">

                                    <div style="cursor: pointer;" class="p-2 rounded-full text-black ">
                                  {% is_favorites_icon request.user post.id%}
                                      
                                      </div>

                              <span>{% is_favorites request.user post.id%}</span>


                                    </a> 
                                </li>

                                {% if post.user == request.user %}
                                <li>
                                  <hr class="-mx-2 my-2 ">
                                </li>

                                <li> 
                                    <button onclick="hideDropdown()" type="button" href="#" data-modal-toggle="defaultModal" class="w-full flex items-center px-3 py-2 text-red-500 hover:bg-red-100 hover:text-red-500 rounded-md ">
                                     <i class="uil-trash-alt mr-1"></i>  Delete
                                    </button> 
                                </li>

                                {% endif %}
                              </ul>


                        
                        </div>
                      </div>
                    </div>

                        <!-- Delete modal -->
<div id="defaultModal" tabindex="-1" aria-hidden="true" class="hidden overflow-y-auto overflow-x-hidden fixed top-0 right-0 left-0 z-50 w-3/12 md:inset-0 h-modal md:h-2/4">
<div class="relative p-4 w-3/12 max-w-2xl h-2/4 md:h-auto">
<!-- Modal content -->
<div class="relative bg-white rounded-lg shadow dark:bg-gray-700">
    <!-- Modal header -->
    <div class="flex justify-between items-start p-4 rounded-t border-b dark:border-gray-600">
        <h3 class="text-xl font-semibold text-gray-900 dark:text-white">
            Are you sure you want to delete?
        </h3>
        <button type="button" class="text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm p-1.5 ml-auto inline-flex items-center dark:hover:bg-gray-600 dark:hover:text-white" data-modal-toggle="defaultModal">
            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg>  
        </button>
    </div>

    <!-- Modal footer -->
    <div class="flex items-center p-6 space-x-2 rounded-b border-t border-gray-200 dark:border-gray-600">
        <button id="delete#{{post.id}}" data-modal-toggle="defaultModal" type="button" class="delete text-white bg-red-700 hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-red-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center dark:bg-red-600 dark:hover:bg-red-700 dark:focus:ring-red-800">Delete</button>
        <button data-modal-toggle="defaultModal" type="button" class="text-gray-500 bg-white hover:bg-gray-100 focus:ring-4 focus:outline-none focus:ring-blue-300 rounded-lg border border-gray-200 text-sm font-medium px-5 py-2.5 hover:text-gray-900 focus:z-10 dark:bg-gray-700 dark:text-gray-300 dark:border-gray-500 dark:hover:text-white dark:hover:bg-gray-600 dark:focus:ring-gray-600">Cancel</button>
    </div>
</div>
</div>
</div>

                    <div uk-lightbox>
                        <a href="/media/{{post.image }}">  
                            <img src="/media/{{post.image }}" alt="">
                        </a>
                    </div>
                    

                    <div class="py-3 px-4 space-y-3"> 
                       
                        <div class="flex space-x-4 lg:font-bold">
                            <a class="flex items-center space-x-2">

                                {% comment %} Like Post {% endcomment %}
                        
                                <div id="{{post.id}}" style="cursor: pointer;" class="p-2 rounded-full text-black like">
                                    {%  liked_by_user_icon request.user post.id %}
                                </div>
                            <span id="like#{{post.id}}">{%  liked_by_user request.user post.id %}</span>
                            
                            </a>
                            <a class="flex items-center space-x-2">
                                <div class="p-2 rounded-full text-black">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" width="25" height="25" class="">
                                        <path fill-rule="evenodd" d="M18 5v8a2 2 0 01-2 2h-5l-5 4v-4H4a2 2 0 01-2-2V5a2 2 0 012-2h12a2 2 0 012 2zM7 8H5v2h2V8zm2 0h2v2H9V8zm6 0h-2v2h2V8z" clip-rule="evenodd" />
                                    </svg>  
                                </div> <span id="commentsCount">{{ post.comments.all.count }}</span>
                                
                            </a>
                            <a href="#" class="flex items-center space-x-2 flex-1 justify-end">
                                <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="25" height="25" preserveAspectRatio="xMidYMid meet" viewBox="0 0 16 16"><g fill="currentColor"><path d="M8.5 1.5A1.5 1.5 0 0 1 10 0h4a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h6c-.314.418-.5.937-.5 1.5v6h-2a.5.5 0 0 0-.354.854l2.5 2.5a.5.5 0 0 0 .708 0l2.5-2.5A.5.5 0 0 0 10.5 7.5h-2v-6z"/></g></svg> 
                                
                            </a>
                        </div>
                        <div class="flex items-center space-x-3"> 
                            <div class="flex items-center">
         
                            </div>

                        </div>

                        {% if misc == 'edit_post' %}

             

                        <form method="post"> {% csrf_token %}

                            {{ form.caption }}

                            {% comment %} <textarea type="text" class="mt-5" name="caption" id="captions" placeholder="Post Caption"  cols="30" rows="10"></textarea> {% endcomment %}

                            <div uk-form-custom class="mt-5">
                                <input  type="submit">
                                
                            </div>
                        </form>

     
                          {% else %}

                          <p> {% replace_hash post.caption %} </p>

                        <div class="bg-gray-100 bg-gray-100 rounded-full rounded-md relative ">


                            <form method="post"> {% csrf_token %}

                            <input oninvalid="this.setCustomValidity('Enter atleast 2 characters')" required id="comment#{{post.id}}" name="comment" minlength="2" type="text" placeholder="Post a comment" class="bg-transparent max-h-10 shadow-none">

                            <div class="absolute bottom-0 flex h-full items-center right-0 right-3 text-xl space-x-2">

                            <input type="hidden" name="post" value="{{post.id}}">
                                
                               <button class="post-comment comment-form" id="post#{{post.id}}" type="submit">Send</button>

                            </form>
                            </div>
                        </div>

                        <div class="comments-container_{{post.id}} border-t pt-4 space-y-4 ">

                
                            {% comment %} Comments start {% endcomment %}

                            {% for comment in comments  %}

                            <div id="commentbox#{{comment.id}}" class="flex comment-box">
                                
                                <div class="w-10 h-10 rounded-full relative flex-shrink-0">
                                    <img src="/media/{% get_profile_image comment.user %}" alt="" class="absolute h-full rounded-full w-full">
                                </div>
                                <div class="w-full text-gray-700 py-2 px-3 rounded-md bg-gray-100 h-full relative lg:ml-5 ml-2 lg:mr-20 ">

                                
                           <div>   {% replace_hash comment.comment %} 

                            
                            <i id="comment#{{comment.id}}" style="cursor: pointer;" class="comment fa-solid fa-thumbs-up"> 
                             </i> 

                             <span id="commentlike#{{comment.id}}"> {{ comment.comment_like.all.count}}</span>

                             {% if request.user == comment.user %}
                            
                             <i id="deletecomment#{{comment.id}}" style="cursor: pointer;" class="right-2 absolute deletecomment fa-solid fa-trash"></i>
                    

                             {% endif %}
                        </div>

           

                                <div class="absolute w-3 h-3 top-3 -left-1 bg-gray-100 transform rotate-45 "></div>


                                
                                </div>


                            </div>

                          {% endfor %}
                            
                      </div>

                        {% endif %}

                    </div>

                </div>


            </div>

            <!-- right sidebar-->
            <div class="lg:w-5/12">

                <div class="bg-white  shadow-md rounded-md overflow-hidden">

                    <div class="bg-gray-50  border-b border-gray-100 flex items-baseline justify-between py-4 px-6 ">
                        <h2 class="font-semibold text-lg">Users You Can Follow</h2>
                     
                    </div>

                    {% if users_to_follow|length_is:"0" %}


                    <div class="divide-gray-300 divide-gray-50 divide-opacity-50 divide-y px-4 ">
                        <div class="flex items-center justify-between py-3">
                            <div class="flex flex-1 items-center space-x-4">
                                No users available to follow right now
                           </div></div></div>
    
                           {% else %}
                   
                    {% for user_profile in users_to_follow %}
    
                   
                    <div class="divide-gray-300 divide-gray-50 divide-opacity-50 divide-y px-4 ">
                        <div class="flex items-center justify-between py-3">
                            <div class="flex flex-1 items-center space-x-4">
                                <a href="profile.html">
                                    <img src="/media/{{user_profile.profile_image}}" class="bg-gray-200 rounded-full w-10 h-10">
                                </a>
                                <div class="flex flex-col">
                                    <a href="{% url 'profile' user_profile.user %}"><span class="block capitalize font-semibold"> {{user_profile.user}} </span></a>
                                    <span id="followcount#{{user_profile.user}}" class="block capitalize text-sm"> {{user_profile.followers.all.count }} followers</span>
                                </div>
                            </div>
                            
                            <a href="#" id="follow#{{user_profile.user}}" class="border border-gray-200 font-semibold px-4 py-1 rounded-full hover:bg-pink-600 hover:text-white hover:border-pink-600 follow"> {% is_following request.user user_profile.user %} </a>
                        </div> 
                    </div>
    
                    {% endfor %}
    
                    {% endif %}

                    {% comment %}  End Users to Follow  {% endcomment %}

                </div>

              

            </div>

        </div>               
  

    </div>

</div>

</div>

{% endblock content %}